<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<title>PDF Checker</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
<h3>وب‌اپ PDF Checker</h3>
<form id="uploadForm" class="mb-3">
  <input class="form-control" type="file" id="file" accept="application/pdf">
  <button class="btn btn-primary mt-2" type="submit">ارسال و بررسی</button>
</form>
<div id="result" class="mt-4"></div>
<script>
const form=document.getElementById('uploadForm');
form.addEventListener('submit', async(e)=>{
  e.preventDefault();
  const fileEl=document.getElementById('file');
  if(!fileEl.files.length) return alert('یک فایل انتخاب کنید.');
  const fd=new FormData();
  fd.append('file', fileEl.files[0]);
  const res=await fetch('/analyze',{method:'POST',body:fd});
  const data=await res.json();
  const out=document.getElementById('result');
  if(data.error){out.innerHTML='<div class="alert alert-danger">'+data.error+'</div>';return;}
  let html='';
  data.pages.forEach(p=>{
    html+=`<div class="card mb-3"><div class="card-body">`;
    html+=`<h5>صفحه ${p.page}</h5>`;
    html+=`<p><strong>نام ذی‌نفع:</strong> ${p.extracted.beneficiary || '<em>یافت نشد</em>'}</p>`;
    html+=`<p><strong>جمع نهایی:</strong> ${p.extracted.total || '<em>یافت نشد</em>'} <strong>واحد:</strong> ${p.extracted.currency || '<em>یافت نشد</em>'}</p>`;
    html+=`<p><strong>بانک:</strong> ${p.extracted.bank || '<em>یافت نشد</em>'} <strong>شماره حساب/شبا:</strong> ${p.extracted.account || '<em>یافت نشد</em>'}</p>`;
    html+=`</div></div>`;
  });
  out.innerHTML=html;
});
</script>
</div>
</body>
</html>